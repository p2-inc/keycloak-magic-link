<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
  <changeSet author="akash@atomic.work" id="tinyurl-1.0">

    <createTable tableName="tiny_url">
      <column name="id" type="BIGINT">
        <constraints nullable="false"/>
      </column>
      <column name="realm_id" type="VARCHAR(255)">
        <constraints nullable="false"/>
      </column>
      <column name="url_key" type="VARCHAR(8)">
        <constraints nullable="false" unique="true"/>
      </column>
      <column name="full_url" type="TEXT">
        <constraints nullable="false"/>
      </column>
      <column name="created_at" type="TIMESTAMP WITHOUT TIME ZONE">
        <constraints nullable="false"/>
      </column>
    </createTable>

    <addPrimaryKey
      constraintName="PK_TINY_URL"
      tableName="tiny_url"
      columnNames="id"
    />
    <createIndex indexName="idx_tiny_url_realm_id_url_key" tableName="tiny_url" unique="true">
      <column name="realm_id"/>
      <column name="url_key"/>
    </createIndex>

  </changeSet>

</databaseChangeLog>
